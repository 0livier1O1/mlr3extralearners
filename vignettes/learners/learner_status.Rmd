---
title: "Learner Status"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo = FALSE}
library(mlr3extralearners)
tbl = list_mlr3learners(select = c("id", "required_packages", "mlr3_package"))
tbl[,Package := sapply(required_packages, function(x) x[1])]
tbl$required_packages = NULL
tbl$Author = apply(tbl, 1, function(row) {
  if (row[[2]] == "mlr3extralearners") {
    x = readLines(file.path("~", "GitHub", "mlr3extralearners", "man", paste0("mlr_learners_", row[[1]], ".Rd")))
    return(paste0("@", x[which(grepl("author", x)) + 1]))
  } else if (row[[2]] == "mlr3proba") {
    return("@RaphaelS1")
  } else {
    return("@mllg")
  }
})

# this can be tidied up
tbl[,Package := ifelse(is.na(Package), "mlr3", Package)]
tbl[,Package := ifelse(Package == "reticulate", "pycox", Package)]
tbl[,Package := ifelse(Package %in% c("keras", "pracma"), "proba", Package)]
tbl[,Status := ifelse(mlr3_package == "mlr3extralearners",
  sprintf("![%s](https://github.com/mlr-org/mlr3extralearners/workflows/%s%s(macOS-latest,%srelease)/badge.svg)", Package, Package, "%20", "%20"),
  ifelse(mlr3_package == "mlr3",
         "![mlr3](https://github.com/mlr-org/mlr3/workflows/tic/badge.svg)",
         ifelse(mlr3_package == "mlr3learners",
                "![mlr3learners](https://github.com/mlr-org/mlr3learners/workflows/tic/badge.svg)",
                "![mlr3proba](https://github.com/mlr-org/mlr3proba/workflows/tic/badge.svg)")))]
# fix edge cases


colnames(tbl)[1:2] = c("Key", "mlr3Package")
tbl = tbl[,c(1, 2, 3, 5, 4)]
knitr::kable(tbl, "pipe")
```